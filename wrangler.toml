name = "mapifi"
main = "src/worker.js"
compatibility_date = "2026-01-06"
workers_dev = true

[vars]
# Back-compat single-feed (still supported if GTFS_RT_FEEDS is empty)
GTFS_RT_URL = "https://api.transport.nsw.gov.au/v1/gtfs/vehiclepos/buses"
GTFS_RT_AUTH_HEADER = "Authorization"
GTFS_RT_AUTH_QUERY = ""

# Multi-feed mode (JSON).
# The Worker will:
#  - GET all feeds when ?feed=all (default)
#  - GET just one feed when ?feed=buses / ?feed=ferries / ...
#  - Skip failing feeds and report them in `errors`
GTFS_RT_FEEDS = '''
[
  {
    "id": "buses",
    "label": "Buses",
    "url": "https://api.transport.nsw.gov.au/v1/gtfs/vehiclepos/buses",
    "icon": "/emoji/bus.png",
    "facing": "right"
  },
  {
    "id": "ferries",
    "label": "Ferries",
    "url": "https://api.transport.nsw.gov.au/v1/gtfs/vehiclepos/ferries",
    "icon": "/emoji/ferry.png",
    "facing": "right"
  },
  {
    "id": "lightrail",
    "label": "Light Rail",
    "url": "https://api.transport.nsw.gov.au/v1/gtfs/vehiclepos/lightrail",
    "icon": "/emoji/light-rail.png",
    "facing": "right"
  },
  {
    "id": "sydneytrains",
    "label": "Sydney Trains",
    "url": "https://api.transport.nsw.gov.au/v1/gtfs/vehiclepos/sydneytrains",
    "icon": "/emoji/metro.png",
    "facing": "right"
  },
  {
    "id": "nswtrains",
    "label": "NSW Trains",
    "url": "https://api.transport.nsw.gov.au/v1/gtfs/vehiclepos/nswtrains",
    "icon": "/emoji/train.png",
    "facing": "right"
  }
]
'''

[assets]
directory = "./public"
binding = "ASSETS"
not_found_handling = "single-page-application"
